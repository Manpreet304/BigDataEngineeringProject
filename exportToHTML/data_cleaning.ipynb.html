<html>
<head>
<title>data_cleaning.ipynb</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #7a7e85;}
.s1 { color: #bcbec4;}
.s2 { color: #cf8e6d;}
.s3 { color: #bcbec4;}
.s4 { color: #6aab73;}
.s5 { color: #2aacb8;}
.ls0 { height: 1px; border-width: 0; color: #43454a; background-color:#43454a}
</style>
</head>
<body bgcolor="#1e1f22">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
data_cleaning.ipynb</font>
</center></td></tr></table>
<pre><span class="s0">#%% md 
</span><span class="s1"># Data Cleaning Exercise 
 
Cleaning your data is crucial when starting a new data engineering project because it ensures the accuracy, consistency, and reliability of the dataset. Dirty data, which may include duplicates, missing values, and errors, can lead to incorrect analysis and insights, ultimately affecting the decision-making process. Data cleaning helps in identifying and rectifying these issues, providing a solid foundation for building effective data models and analytics. Additionally, clean data improves the performance of algorithms and enhances the overall efficiency of the project, leading to more trustworthy and actionable results. <hr class="ls0"></span><span class="s0">#%% md 
</span><span class="s1">Use Python, ```numpy```, ```pandas``` and/or ```matplotlib``` to analyse and clean your batch data: <hr class="ls0"></span><span class="s0">#%% md 
</span><span class="s1">## Import Libraries <hr class="ls0"></span><span class="s0">#%% 
# TODO</span>
<span class="s2">import </span><span class="s1">numpy </span><span class="s2">as </span><span class="s1">np</span>
<span class="s2">import </span><span class="s1">pandas </span><span class="s2">as </span><span class="s1">pd</span>
<span class="s2">import </span><span class="s1">matplotlib</span><span class="s3">.</span><span class="s1">pyplot </span><span class="s2">as </span><span class="s1">plot</span><hr class="ls0"><span class="s0">#%% md 
</span><span class="s1">## Load Data 
 
Link to data source: ```&lt;TODO&gt;``` <hr class="ls0"></span><span class="s0">#%% 
# TODO</span>
<span class="s1">file_path </span><span class="s3">= </span><span class="s4">r'../Job Posting.csv/Job Posting.csv'</span>
<span class="s2">try</span><span class="s3">:</span>
    <span class="s1">rawdata </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">read_csv</span><span class="s3">(</span><span class="s1">file_path</span><span class="s3">, </span><span class="s1">encoding</span><span class="s3">=</span><span class="s4">'latin1'</span><span class="s3">)</span>
    <span class="s1">print</span><span class="s3">(</span><span class="s4">&quot;Datei erfolgreich geladen.&quot;</span><span class="s3">)</span>
<span class="s2">except </span><span class="s1">FileNotFoundError</span><span class="s3">:</span>
    <span class="s1">print</span><span class="s3">(</span><span class="s4">f&quot;Datei nicht gefunden: </span><span class="s2">{</span><span class="s1">file_path</span><span class="s2">}</span><span class="s4">&quot;</span><span class="s3">)</span>
<span class="s2">except </span><span class="s1">Exception </span><span class="s2">as </span><span class="s1">e</span><span class="s3">:</span>
    <span class="s1">print</span><span class="s3">(</span><span class="s4">f&quot;Fehler beim Laden der Datei: </span><span class="s2">{</span><span class="s1">e</span><span class="s2">}</span><span class="s4">&quot;</span><span class="s3">)</span><hr class="ls0"><span class="s0">#%% md 
</span><span class="s1">## Understand the Data 
 
View the first few rows, get summary statistics and check data types <hr class="ls0"></span><span class="s0">#%% 
# TODO</span>
<span class="s1">rawdata</span><span class="s3">.</span><span class="s1">head</span><span class="s3">()</span>

<span class="s1">rawdata</span><span class="s3">.</span><span class="s1">describe</span><span class="s3">(</span><span class="s1">include</span><span class="s3">=</span><span class="s4">'all'</span><span class="s3">).</span><span class="s1">transpose</span><span class="s3">()</span>

<span class="s1">summary </span><span class="s3">= </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">DataFrame</span><span class="s3">({</span>
    <span class="s4">'datatype'</span><span class="s3">:         </span><span class="s1">rawdata</span><span class="s3">.</span><span class="s1">dtypes</span><span class="s3">,</span>
    <span class="s4">'non_null_count'</span><span class="s3">:   </span><span class="s1">rawdata</span><span class="s3">.</span><span class="s1">count</span><span class="s3">(),</span>
    <span class="s4">'missing_count'</span><span class="s3">:    </span><span class="s1">rawdata</span><span class="s3">.</span><span class="s1">isnull</span><span class="s3">().</span><span class="s1">sum</span><span class="s3">(),</span>
    <span class="s4">'missing_percent'</span><span class="s3">:  (</span><span class="s1">rawdata</span><span class="s3">.</span><span class="s1">isnull</span><span class="s3">().</span><span class="s1">mean</span><span class="s3">() * </span><span class="s5">100</span><span class="s3">).</span><span class="s1">round</span><span class="s3">(</span><span class="s5">1</span><span class="s3">)</span>
<span class="s3">})</span>
<span class="s1">summary</span><hr class="ls0"><span class="s0">#%% md 
</span><span class="s1">## Handle Missing Data 
 
Identify missing values and fill or drop missing values <hr class="ls0"></span><span class="s0">#%% 
# TODO</span>
<span class="s0"># 1) Überblick vor dem Reinigen</span>
<span class="s1">print</span><span class="s3">(</span><span class="s4">&quot;Shape before cleaning:&quot;</span><span class="s3">, </span><span class="s1">rawdata</span><span class="s3">.</span><span class="s1">shape</span><span class="s3">)</span>
<span class="s1">print</span><span class="s3">(</span><span class="s4">&quot;</span><span class="s2">\n</span><span class="s4">Missing values before cleaning:</span><span class="s2">\n</span><span class="s4">&quot;</span><span class="s3">, </span><span class="s1">rawdata</span><span class="s3">.</span><span class="s1">isnull</span><span class="s3">().</span><span class="s1">sum</span><span class="s3">())</span>

<span class="s0"># wir legen eine neue Variable an, damit rawdata erhalten bleibt</span>
<span class="s1">data </span><span class="s3">= </span><span class="s1">rawdata</span><span class="s3">.</span><span class="s1">copy</span><span class="s3">()</span>

<span class="s0"># 2) Spalten mit zu vielen Nulls (&gt; 80 %) droppen</span>
<span class="s1">threshold </span><span class="s3">= </span><span class="s5">0.8</span>
<span class="s1">high_null_columns </span><span class="s3">= </span><span class="s1">data</span><span class="s3">.</span><span class="s1">columns</span><span class="s3">[</span><span class="s1">data</span><span class="s3">.</span><span class="s1">isnull</span><span class="s3">().</span><span class="s1">mean</span><span class="s3">() &gt; </span><span class="s1">threshold</span><span class="s3">].</span><span class="s1">tolist</span><span class="s3">()</span>
<span class="s1">print</span><span class="s3">(</span><span class="s4">f&quot;</span><span class="s2">\n</span><span class="s4">Spalten mit mehr als </span><span class="s2">{</span><span class="s1">int</span><span class="s3">(</span><span class="s1">threshold </span><span class="s3">* </span><span class="s5">100</span><span class="s3">)</span><span class="s2">} </span><span class="s4">% Nulls, die gedroppt werden:&quot;</span><span class="s3">, </span><span class="s1">high_null_columns</span><span class="s3">)</span>
<span class="s1">data </span><span class="s3">= </span><span class="s1">data</span><span class="s3">.</span><span class="s1">drop</span><span class="s3">(</span><span class="s1">columns</span><span class="s3">=</span><span class="s1">high_null_columns</span><span class="s3">)</span>

<span class="s0"># 3) Numerische Spalten mit Median füllen</span>
<span class="s1">number_columns </span><span class="s3">= </span><span class="s1">data</span><span class="s3">.</span><span class="s1">select_dtypes</span><span class="s3">(</span><span class="s1">include</span><span class="s3">=</span><span class="s4">'number'</span><span class="s3">).</span><span class="s1">columns</span>
<span class="s1">medians </span><span class="s3">= </span><span class="s1">data</span><span class="s3">[</span><span class="s1">number_columns</span><span class="s3">].</span><span class="s1">median</span><span class="s3">()</span>
<span class="s1">data</span><span class="s3">[</span><span class="s1">number_columns</span><span class="s3">] = </span><span class="s1">data</span><span class="s3">[</span><span class="s1">number_columns</span><span class="s3">].</span><span class="s1">fillna</span><span class="s3">(</span><span class="s1">medians</span><span class="s3">)</span>

<span class="s0"># 4) String-Spalten mit 'Unknown' füllen</span>
<span class="s1">string_columns </span><span class="s3">= </span><span class="s1">data</span><span class="s3">.</span><span class="s1">select_dtypes</span><span class="s3">(</span><span class="s1">include</span><span class="s3">=[</span><span class="s4">'object'</span><span class="s3">]).</span><span class="s1">columns</span>
<span class="s2">for </span><span class="s1">col </span><span class="s2">in </span><span class="s1">string_columns</span><span class="s3">:</span>
    <span class="s1">data</span><span class="s3">[</span><span class="s1">col</span><span class="s3">] = </span><span class="s1">data</span><span class="s3">[</span><span class="s1">col</span><span class="s3">].</span><span class="s1">fillna</span><span class="s3">(</span><span class="s4">'Unknown'</span><span class="s3">)</span>

<span class="s0"># 5) Kontrolle nach dem Reinigen</span>
<span class="s1">print</span><span class="s3">(</span><span class="s4">&quot;</span><span class="s2">\n</span><span class="s4">Shape after cleaning:&quot;</span><span class="s3">, </span><span class="s1">data</span><span class="s3">.</span><span class="s1">shape</span><span class="s3">)</span>
<span class="s1">print</span><span class="s3">(</span><span class="s4">&quot;</span><span class="s2">\n</span><span class="s4">Missing values after cleaning:</span><span class="s2">\n</span><span class="s4">&quot;</span><span class="s3">, </span><span class="s1">data</span><span class="s3">.</span><span class="s1">isnull</span><span class="s3">().</span><span class="s1">sum</span><span class="s3">())</span>
<hr class="ls0"><span class="s0">#%% md 
</span><span class="s1">## Handle Duplicates 
 
Identify duplicates and remove them <hr class="ls0"></span><span class="s0">#%% 
# TODO</span>
<span class="s1">print</span><span class="s3">(</span><span class="s4">&quot;Duplicates sum:&quot;</span><span class="s3">, </span><span class="s1">data</span><span class="s3">.</span><span class="s1">duplicated</span><span class="s3">().</span><span class="s1">sum</span><span class="s3">())</span><hr class="ls0"><span class="s0">#%% md 
</span><span class="s1">## Handle Outliers 
 
Identify outliers and remove or corret them <hr class="ls0"></span><span class="s0">#%% 
# TODO</span>
<span class="s0"># Prüfen, ob numerische Spalten vorhanden sind</span>
<span class="s1">numeric_cols </span><span class="s3">= </span><span class="s1">data</span><span class="s3">.</span><span class="s1">select_dtypes</span><span class="s3">(</span><span class="s1">include</span><span class="s3">=</span><span class="s4">'number'</span><span class="s3">).</span><span class="s1">columns</span>
<span class="s2">if </span><span class="s1">numeric_cols</span><span class="s3">.</span><span class="s1">empty</span><span class="s3">:</span>
    <span class="s1">print</span><span class="s3">(</span><span class="s4">&quot;Keine numerischen Spalten (int/float) vorhanden – Ausreißer-Analyse entfällt.&quot;</span><span class="s3">)</span>
<span class="s2">else</span><span class="s3">:</span>
    <span class="s0"># Dein IQR-Code hier</span>
    <span class="s2">for </span><span class="s1">col </span><span class="s2">in </span><span class="s1">numeric_cols</span><span class="s3">:</span>
        <span class="s1">Q1 </span><span class="s3">= </span><span class="s1">data</span><span class="s3">[</span><span class="s1">col</span><span class="s3">].</span><span class="s1">quantile</span><span class="s3">(</span><span class="s5">0.25</span><span class="s3">)</span>
        <span class="s1">Q3 </span><span class="s3">= </span><span class="s1">data</span><span class="s3">[</span><span class="s1">col</span><span class="s3">].</span><span class="s1">quantile</span><span class="s3">(</span><span class="s5">0.75</span><span class="s3">)</span>
        <span class="s1">IQR </span><span class="s3">= </span><span class="s1">Q3 </span><span class="s3">- </span><span class="s1">Q1</span>
        <span class="s1">mask </span><span class="s3">= (</span><span class="s1">data</span><span class="s3">[</span><span class="s1">col</span><span class="s3">] &lt; </span><span class="s1">Q1 </span><span class="s3">- </span><span class="s5">1.5 </span><span class="s3">* </span><span class="s1">IQR</span><span class="s3">) | (</span><span class="s1">data</span><span class="s3">[</span><span class="s1">col</span><span class="s3">] &gt; </span><span class="s1">Q3 </span><span class="s3">+ </span><span class="s5">1.5 </span><span class="s3">* </span><span class="s1">IQR</span><span class="s3">)</span>
        <span class="s1">print</span><span class="s3">(</span><span class="s4">f&quot;</span><span class="s2">{</span><span class="s1">col</span><span class="s2">}</span><span class="s4">: </span><span class="s2">{</span><span class="s1">mask</span><span class="s3">.</span><span class="s1">sum</span><span class="s3">()</span><span class="s2">} </span><span class="s4">Ausreißer&quot;</span><span class="s3">)</span>

<hr class="ls0"><span class="s0">#%% md 
</span><span class="s1">## Handle Incorrect Data Types <hr class="ls0"></span><span class="s0">#%% 
# TODO</span>

<span class="s2">import </span><span class="s1">re</span>

<span class="s0"># 1) Aktuelle Datentypen</span>
<span class="s1">print</span><span class="s3">(</span><span class="s4">&quot;Current datatypes:&quot;</span><span class="s3">)</span>
<span class="s1">print</span><span class="s3">(</span><span class="s1">data</span><span class="s3">.</span><span class="s1">dtypes</span><span class="s3">, </span><span class="s4">&quot;</span><span class="s2">\n</span><span class="s4">&quot;</span><span class="s3">)</span>

<span class="s0"># 2) Für jede object-Spalte prüfen</span>
<span class="s1">total </span><span class="s3">= </span><span class="s1">len</span><span class="s3">(</span><span class="s1">data</span><span class="s3">)</span>
<span class="s1">date_regex </span><span class="s3">= </span><span class="s1">re</span><span class="s3">.</span><span class="s1">compile</span><span class="s3">(</span><span class="s4">r'^\d{4}-\d{2}-\d{2}T'</span><span class="s3">)  </span><span class="s0"># ISO-8601 Beginn: YYYY-MM-DDT</span>

<span class="s2">for </span><span class="s1">col </span><span class="s2">in </span><span class="s1">data</span><span class="s3">.</span><span class="s1">select_dtypes</span><span class="s3">(</span><span class="s1">include</span><span class="s3">=</span><span class="s4">'object'</span><span class="s3">).</span><span class="s1">columns</span><span class="s3">:</span>
    <span class="s0"># Prozent numeric</span>
    <span class="s1">num_pct </span><span class="s3">= (</span><span class="s1">pd</span><span class="s3">.</span><span class="s1">to_numeric</span><span class="s3">(</span><span class="s1">data</span><span class="s3">[</span><span class="s1">col</span><span class="s3">], </span><span class="s1">errors</span><span class="s3">=</span><span class="s4">'coerce'</span><span class="s3">).</span><span class="s1">notnull</span><span class="s3">().</span><span class="s1">mean</span><span class="s3">() * </span><span class="s5">100</span><span class="s3">).</span><span class="s1">round</span><span class="s3">(</span><span class="s5">1</span><span class="s3">)</span>

    <span class="s0"># Prozent, der mit dem RegEx als Datum erkannt wird</span>
    <span class="s1">date_pct </span><span class="s3">= (</span><span class="s1">data</span><span class="s3">[</span><span class="s1">col</span><span class="s3">].</span><span class="s1">astype</span><span class="s3">(</span><span class="s1">str</span><span class="s3">)</span>
                <span class="s3">.</span><span class="s1">str</span><span class="s3">.</span><span class="s1">match</span><span class="s3">(</span><span class="s1">date_regex</span><span class="s3">)</span>
                <span class="s3">.</span><span class="s1">mean</span><span class="s3">() * </span><span class="s5">100</span><span class="s3">).</span><span class="s1">round</span><span class="s3">(</span><span class="s5">1</span><span class="s3">)</span>

    <span class="s1">print</span><span class="s3">(</span><span class="s4">f&quot;</span><span class="s2">{</span><span class="s1">col</span><span class="s2">!r}</span><span class="s4">: </span><span class="s2">{</span><span class="s1">num_pct</span><span class="s2">}</span><span class="s4">% numeric, </span><span class="s2">{</span><span class="s1">date_pct</span><span class="s2">}</span><span class="s4">% ISO-Date&quot;</span><span class="s3">)</span>

    <span class="s0"># wenn &gt;90% ISO-Date, tatsächlich umwandeln</span>
    <span class="s2">if </span><span class="s1">date_pct </span><span class="s3">&gt; </span><span class="s5">90</span><span class="s3">:</span>
        <span class="s1">data</span><span class="s3">[</span><span class="s1">col</span><span class="s3">] = </span><span class="s1">pd</span><span class="s3">.</span><span class="s1">to_datetime</span><span class="s3">(</span><span class="s1">data</span><span class="s3">[</span><span class="s1">col</span><span class="s3">], </span><span class="s1">errors</span><span class="s3">=</span><span class="s4">'coerce'</span><span class="s3">)</span>
        <span class="s1">print</span><span class="s3">(</span><span class="s4">f&quot;  → Converted </span><span class="s2">{</span><span class="s1">col</span><span class="s2">!r} </span><span class="s4">to datetime64[ns]&quot;</span><span class="s3">)</span>

<span class="s0"># 3) Neue Typen ansehen</span>
<span class="s1">print</span><span class="s3">(</span><span class="s4">&quot;</span><span class="s2">\n</span><span class="s4">New datatypes:&quot;</span><span class="s3">)</span>
<span class="s1">print</span><span class="s3">(</span><span class="s1">data</span><span class="s3">.</span><span class="s1">dtypes</span><span class="s3">)</span>

<hr class="ls0"><span class="s0">#%% md 
</span><span class="s1">## Visualize Data 
 
Use graphes, plots and/or diagrams to visualize the data <hr class="ls0"></span><span class="s0">#%% 
# TODO</span>

<span class="s0"># 1) Posting-Dauer in Tagen</span>
<span class="s1">data</span><span class="s3">[</span><span class="s4">'duration_days'</span><span class="s3">] = (</span><span class="s1">data</span><span class="s3">[</span><span class="s4">'Last Seen At'</span><span class="s3">] - </span><span class="s1">data</span><span class="s3">[</span><span class="s4">'First Seen At'</span><span class="s3">]).</span><span class="s1">dt</span><span class="s3">.</span><span class="s1">days</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">figure</span><span class="s3">(</span><span class="s1">figsize</span><span class="s3">=(</span><span class="s5">10</span><span class="s3">, </span><span class="s5">6</span><span class="s3">))</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">hist</span><span class="s3">(</span><span class="s1">data</span><span class="s3">[</span><span class="s4">'duration_days'</span><span class="s3">].</span><span class="s1">dropna</span><span class="s3">(), </span><span class="s1">bins</span><span class="s3">=</span><span class="s5">30</span><span class="s3">, </span><span class="s1">color</span><span class="s3">=</span><span class="s4">'skyblue'</span><span class="s3">, </span><span class="s1">edgecolor</span><span class="s3">=</span><span class="s4">'black'</span><span class="s3">)</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">title</span><span class="s3">(</span><span class="s4">'Distribution of Posting Duration (days)'</span><span class="s3">)</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">xlabel</span><span class="s3">(</span><span class="s4">'Days online'</span><span class="s3">)</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">ylabel</span><span class="s3">(</span><span class="s4">'Count'</span><span class="s3">)</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">grid</span><span class="s3">(</span><span class="s2">True</span><span class="s3">, </span><span class="s1">linestyle</span><span class="s3">=</span><span class="s4">'--'</span><span class="s3">, </span><span class="s1">alpha</span><span class="s3">=</span><span class="s5">0.6</span><span class="s3">)</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">tight_layout</span><span class="s3">()</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">show</span><span class="s3">()</span>

<span class="s0"># 2) Top 10 Job Categories</span>
<span class="s1">top_categories </span><span class="s3">= </span><span class="s1">data</span><span class="s3">[</span><span class="s4">'Category'</span><span class="s3">].</span><span class="s1">value_counts</span><span class="s3">().</span><span class="s1">nlargest</span><span class="s3">(</span><span class="s5">10</span><span class="s3">)</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">figure</span><span class="s3">(</span><span class="s1">figsize</span><span class="s3">=(</span><span class="s5">10</span><span class="s3">, </span><span class="s5">6</span><span class="s3">))</span>
<span class="s1">top_categories</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">bar</span><span class="s3">(</span><span class="s1">color</span><span class="s3">=</span><span class="s4">'steelblue'</span><span class="s3">, </span><span class="s1">edgecolor</span><span class="s3">=</span><span class="s4">'black'</span><span class="s3">)</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">title</span><span class="s3">(</span><span class="s4">'Top 10 Job Categories'</span><span class="s3">)</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">xlabel</span><span class="s3">(</span><span class="s4">'Category'</span><span class="s3">)</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">ylabel</span><span class="s3">(</span><span class="s4">'Number of Postings'</span><span class="s3">)</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">xticks</span><span class="s3">(</span><span class="s1">rotation</span><span class="s3">=</span><span class="s5">45</span><span class="s3">, </span><span class="s1">ha</span><span class="s3">=</span><span class="s4">'right'</span><span class="s3">)</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">grid</span><span class="s3">(</span><span class="s1">axis</span><span class="s3">=</span><span class="s4">'y'</span><span class="s3">, </span><span class="s1">linestyle</span><span class="s3">=</span><span class="s4">'--'</span><span class="s3">, </span><span class="s1">alpha</span><span class="s3">=</span><span class="s5">0.6</span><span class="s3">)</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">tight_layout</span><span class="s3">()</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">show</span><span class="s3">()</span>

<span class="s0"># 3) Länge der Job-Beschreibung</span>
<span class="s1">data</span><span class="s3">[</span><span class="s4">'desc_len'</span><span class="s3">] = </span><span class="s1">data</span><span class="s3">[</span><span class="s4">'Description'</span><span class="s3">].</span><span class="s1">astype</span><span class="s3">(</span><span class="s1">str</span><span class="s3">).</span><span class="s1">str</span><span class="s3">.</span><span class="s1">len</span><span class="s3">()</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">figure</span><span class="s3">(</span><span class="s1">figsize</span><span class="s3">=(</span><span class="s5">10</span><span class="s3">, </span><span class="s5">6</span><span class="s3">))</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">hist</span><span class="s3">(</span><span class="s1">data</span><span class="s3">[</span><span class="s4">'desc_len'</span><span class="s3">].</span><span class="s1">dropna</span><span class="s3">(), </span><span class="s1">bins</span><span class="s3">=</span><span class="s5">30</span><span class="s3">, </span><span class="s1">color</span><span class="s3">=</span><span class="s4">'lightgreen'</span><span class="s3">, </span><span class="s1">edgecolor</span><span class="s3">=</span><span class="s4">'black'</span><span class="s3">)</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">title</span><span class="s3">(</span><span class="s4">'Distribution of Description Length'</span><span class="s3">)</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">xlabel</span><span class="s3">(</span><span class="s4">'Characters'</span><span class="s3">)</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">ylabel</span><span class="s3">(</span><span class="s4">'Count'</span><span class="s3">)</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">grid</span><span class="s3">(</span><span class="s2">True</span><span class="s3">, </span><span class="s1">linestyle</span><span class="s3">=</span><span class="s4">'--'</span><span class="s3">, </span><span class="s1">alpha</span><span class="s3">=</span><span class="s5">0.6</span><span class="s3">)</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">tight_layout</span><span class="s3">()</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">show</span><span class="s3">()</span>

<span class="s0"># 4) Seniority-Verteilung</span>
<span class="s1">seniority_counts </span><span class="s3">= </span><span class="s1">data</span><span class="s3">[</span><span class="s4">'Seniority'</span><span class="s3">].</span><span class="s1">value_counts</span><span class="s3">()</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">figure</span><span class="s3">(</span><span class="s1">figsize</span><span class="s3">=(</span><span class="s5">10</span><span class="s3">, </span><span class="s5">6</span><span class="s3">))</span>
<span class="s1">seniority_counts</span><span class="s3">.</span><span class="s1">plot</span><span class="s3">.</span><span class="s1">barh</span><span class="s3">(</span><span class="s1">color</span><span class="s3">=</span><span class="s4">'skyblue'</span><span class="s3">, </span><span class="s1">edgecolor</span><span class="s3">=</span><span class="s4">'black'</span><span class="s3">)</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">title</span><span class="s3">(</span><span class="s4">'Seniority Distribution'</span><span class="s3">)</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">xlabel</span><span class="s3">(</span><span class="s4">'Number of Postings'</span><span class="s3">)</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">ylabel</span><span class="s3">(</span><span class="s4">'Seniority Level'</span><span class="s3">)</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">grid</span><span class="s3">(</span><span class="s1">axis</span><span class="s3">=</span><span class="s4">'x'</span><span class="s3">, </span><span class="s1">linestyle</span><span class="s3">=</span><span class="s4">'--'</span><span class="s3">, </span><span class="s1">alpha</span><span class="s3">=</span><span class="s5">0.6</span><span class="s3">)</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">tight_layout</span><span class="s3">()</span>
<span class="s1">plot</span><span class="s3">.</span><span class="s1">show</span><span class="s3">()</span>
<hr class="ls0"><span class="s0">#%% md 
</span><span class="s1">## Save Cleaned Data <hr class="ls0"></span><span class="s0">#%% 
# TODO</span>

<span class="s1">output_path </span><span class="s3">= </span><span class="s4">'../Job Posting.csv/Job Posting_cleaned.csv'</span>

<span class="s1">data</span><span class="s3">.</span><span class="s1">to_csv</span><span class="s3">(</span><span class="s1">output_path</span><span class="s3">, </span><span class="s1">index</span><span class="s3">=</span><span class="s2">False</span><span class="s3">)</span>

<span class="s1">print</span><span class="s3">(</span><span class="s4">f&quot;Cleaned data saved to: </span><span class="s2">{</span><span class="s1">output_path</span><span class="s2">}</span><span class="s4">&quot;</span><span class="s3">)</span>
</pre>
</body>
</html>